#!/usr/bin/env bash

# 1. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ FLASK_APP (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°)
export FLASK_APP=app.py

# 2. üü¢ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ)
# ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏£‡∏±‡∏ô 'db.create_all()' ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ Flask's context
# ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏£‡∏±‡∏ô‡πÉ‡∏ô "Runtime" ‡∏ã‡∏∂‡πà‡∏á‡∏°‡∏µ DATABASE_URL ‡πÅ‡∏•‡πâ‡∏ß
flask shell -c "from app import db; db.create_all()"

# 3. ‡∏£‡∏±‡∏ô Gunicorn (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°)
exec gunicorn app:app -b 0.0.0.0:$PORT